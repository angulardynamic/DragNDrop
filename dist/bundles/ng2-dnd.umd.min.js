!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms")):"function"==typeof define&&define.amd?define("ng2-dnd",["exports","@angular/core","@angular/forms"],t):t(e["ng2-dnd"]={},e.ng.core,e.ng.forms)}(this,function(e,l,t){"use strict";var r=function(){function e(e){this.name=e}return e.COPY=new e("copy"),e.LINK=new e("link"),e.MOVE=new e("move"),e.NONE=new e("none"),e}(),a=function(){function e(){this.onDragStartClass="dnd-drag-start",this.onDragEnterClass="dnd-drag-enter",this.onDragOverClass="dnd-drag-over",this.onSortableDragClass="dnd-sortable-drag",this.dragEffect=r.MOVE,this.dropEffect=r.MOVE,this.dragCursor="move",this.defaultCursor="pointer"}return e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=l.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),n=function(){function e(){this.allowedDropZones=[]}return e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=l.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();function o(){return new n}function s(e){return"string"==typeof e}var i=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),this.imageElement=e,this.x_offset=t,this.y_offset=r,s(this.imageElement)){var a=this.imageElement;this.imageElement=new HTMLImageElement,this.imageElement.src=a}};function c(e){return e!==undefined&&null!==e}var d=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e[t]},e.prototype.indexOf=function(e,t){return e.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.splice(t,1)},e.prototype.insertItemAt=function(e,t,r){e.splice(r,0,t)},e}(),p=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e.at(t)},e.prototype.indexOf=function(e,t){return e.controls.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.removeAt(t)},e.prototype.insertItemAt=function(e,t,r){e.insert(r,t)},e}(),g=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype.markSortable=function(e){c(this._element)&&this._element.classList.remove(this.config.onSortableDragClass),c(e)&&(this._element=e,this._element.classList.add(this.config.onSortableDragClass))},e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a}]},e.ngInjectableDef=l.defineInjectable({factory:function(){return new e(l.inject(a))},token:e,providedIn:"root"}),e}();function u(e){return new g(e)}var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function h(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var b=function(){function e(e,t,r,a,n){this.dragDropService=t,this.config=r,this.directive=a,this.cdr=n,this.element=e.nativeElement,this.directive.dragHandle=this.element}return e.prototype.ngOnDestroy=function(){this.directive.dragHandle=undefined},e}(),D=function(){function e(e,t,r,a){var i=this;this.dragDropService=t,this.config=r,this.cdr=a,this._dragEnabled=!1,this.dropEnabled=!1,this.dropZones=[],this.cloneItem=!1,this.defaultCursor=this.config.defaultCursor,this.element=e.nativeElement,this.element.style.cursor=this.defaultCursor,this.element.ondragenter=function(e){return i.dragEnter(e)},this.element.ondragover=function(e){return i.dragOver(e),c(e.dataTransfer)&&(e.dataTransfer.dropEffect=i.config.dropEffect.name),!1},this.element.ondragleave=function(e){return i.dragLeave(e)},this.element.ondrop=function(e){return i.drop(e)},this.element.onmousedown=function(e){i.target=e.target},this.element.ondragstart=function(e){var t,r;if(i.dragEnabled&&c(i.dragHandle)&&!i.dragHandle.contains(i.target))e.preventDefault();else if(i.dragStart(e),c(e.dataTransfer)){if(e.dataTransfer.setData("text",""),e.dataTransfer.effectAllowed=i.effectAllowed||i.config.dragEffect.name,c(i.dragImage))if(s(i.dragImage))e.dataTransfer.setDragImage((t=i.dragImage,(r=new HTMLImageElement).src=t,r));else if("function"==typeof i.dragImage)e.dataTransfer.setDragImage(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e(t)}(i.dragImage));else{var a=i.dragImage;e.dataTransfer.setDragImage(a.imageElement,a.x_offset,a.y_offset)}else if(c(i.config.dragImage)){var n=i.config.dragImage;e.dataTransfer.setDragImage(n.imageElement,n.x_offset,n.y_offset)}else i.cloneItem&&(i.dragHelper=i.element.cloneNode(!0),i.dragHelper.classList.add("dnd-drag-item"),i.dragHelper.style.position="absolute",i.dragHelper.style.top="0px",i.dragHelper.style.left="-1000px",i.element.parentElement.appendChild(i.dragHelper),e.dataTransfer.setDragImage(i.dragHelper,e.offsetX,e.offsetY));var o=i._dragHandle?i._dragHandle:i.element;i._dragEnabled?o.style.cursor=i.effectCursor?i.effectCursor:i.config.dragCursor:o.style.cursor=i.defaultCursor}},this.element.ondragend=function(e){i.element.parentElement&&i.dragHelper&&i.element.parentElement.removeChild(i.dragHelper),i.dragEnd(e),(i._dragHandle?i._dragHandle:i.element).style.cursor=i.defaultCursor}}return Object.defineProperty(e.prototype,"dragEnabled",{get:function(){return this._dragEnabled},set:function(e){this._dragEnabled=e,this.element.draggable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragHandle",{get:function(){return this._dragHandle},set:function(e){this._dragHandle=e},enumerable:!0,configurable:!0}),e.prototype.detectChanges=function(){var e=this;setTimeout(function(){e.cdr&&!e.cdr.destroyed&&e.cdr.detectChanges()},250)},e.prototype.dragEnter=function(e){this.isDropAllowed(e)&&this.dragEnterCallback(e)},e.prototype.dragOver=function(e){this.isDropAllowed(e)&&(c(e.preventDefault)&&e.preventDefault(),this.dragOverCallback(e))},e.prototype.dragLeave=function(e){this.isDropAllowed(e)&&this.dragLeaveCallback(e)},e.prototype.drop=function(e){this.isDropAllowed(e)&&(this.preventAndStop(e),this.dropCallback(e),this.detectChanges())},e.prototype.isDropAllowed=function(e){if((this.dragDropService.isDragged||e.dataTransfer&&e.dataTransfer.files)&&this.dropEnabled){if(c(this.allowDrop))return this.allowDrop(this.dragDropService.dragData);if(0===this.dropZones.length&&0===this.dragDropService.allowedDropZones.length)return!0;try{for(var t=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}(this.dragDropService.allowedDropZones),r=t.next();!r.done;r=t.next()){var a=r.value;if(-1!==this.dropZones.indexOf(a))return!0}}catch(i){n={error:i}}finally{try{r&&!r.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}}return!1;var n,o},e.prototype.preventAndStop=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},e.prototype.dragStart=function(e){this.dragEnabled&&(this.dragDropService.allowedDropZones=this.dropZones,this.dragStartCallback(e),e.stopPropagation&&e.stopPropagation())},e.prototype.dragEnd=function(e){this.dragDropService.allowedDropZones=[],this.dragEndCallback(e)},e.prototype.dragEnterCallback=function(e){},e.prototype.dragOverCallback=function(e){},e.prototype.dragLeaveCallback=function(e){},e.prototype.dropCallback=function(e){},e.prototype.dragStartCallback=function(e){},e.prototype.dragEndCallback=function(e){},e}(),v=function(o){function e(e,t,r,a){var n=o.call(this,e,t,r,a)||this;return n.onDragStart=new l.EventEmitter,n.onDragEnd=new l.EventEmitter,n.onDragSuccess=new l.EventEmitter,n.defaultCursor=n.element.style.cursor,n.dragEnabled=!0,n}return h(e,o),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype.dragStartCallback=function(){this.dragDropService.isDragged=!0,this.dragDropService.dragData=this.dragData,this.dragDropService.onDragSuccessCallback=this.onDragSuccess,this.element.classList.add(this.config.onDragStartClass)},e.prototype.dragEndCallback=function(e){this.dragDropService.isDragged=!1,this.dragDropService.dragData=null,this.dragDropService.onDragSuccessCallback=null,this.element.classList.remove(this.config.onDragStartClass),this.onDragEnd.emit({dragData:this.dragData,mouseEvent:e})},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef}]},e.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],dragData:[{type:l.Input}],dragImage:[{type:l.Input}],cloneItem:[{type:l.Input}],onDragStart:[{type:l.Output}],onDragEnd:[{type:l.Output}],onDragSuccess:[{type:l.Output}]},e}(D),m=function(o){function e(e,t,r,a,n){return o.call(this,e,t,r,a,n)||this}return h(e,o),e.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable-handle"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:v},{type:l.ChangeDetectorRef}]},e}(b),y=function(o){function e(e,t,r,a){var n=o.call(this,e,t,r,a)||this;return n.onDropSuccess=new l.EventEmitter,n.onDragEnter=new l.EventEmitter,n.onDragOver=new l.EventEmitter,n.onDragLeave=new l.EventEmitter,n.dropEnabled=!0,n}return h(e,o),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowdrop",{set:function(e){this.allowDrop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype.dragEnterCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.add(this.config.onDragEnterClass),this.onDragEnter.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dragOverCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.add(this.config.onDragOverClass),this.onDragOver.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dragLeaveCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.remove(this.config.onDragOverClass),this.element.classList.remove(this.config.onDragEnterClass),this.onDragLeave.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dropCallback=function(e){var t=e.dataTransfer;(this.dragDropService.isDragged||c(t)&&c(t.files))&&(this.onDropSuccess.emit({dragData:this.dragDropService.dragData,mouseEvent:e}),c(this.dragDropService.onDragSuccessCallback)&&this.dragDropService.onDragSuccessCallback.emit({dragData:this.dragDropService.dragData,mouseEvent:e}),this.element.classList.remove(this.config.onDragOverClass),this.element.classList.remove(this.config.onDragEnterClass))},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-droppable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef}]},e.propDecorators={droppable:[{type:l.Input,args:["dropEnabled"]}],allowdrop:[{type:l.Input,args:["allowDrop"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],onDropSuccess:[{type:l.Output}],onDragEnter:[{type:l.Output}],onDragOver:[{type:l.Output}],onDragLeave:[{type:l.Output}]},e}(D),S=function(i){function e(e,t,r,a,n){var o=i.call(this,e,t,r,a)||this;return o._sortableDataService=n,o._sortableData=[],o.dragEnabled=!1,o}return h(e,i),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortableData",{get:function(){return this._sortableData},set:function(e){(this._sortableData=e)instanceof t.FormArray?this.sortableHandler=new p:this.sortableHandler=new d,this.dropEnabled=!!this._sortableData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);-1===this.indexOf(t)&&(this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer._sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this.insertItemAt(t,0),(this._sortableDataService.sortableContainer=this)._sortableDataService.index=0),this.detectChanges()}},e.prototype.getItemAt=function(e){return this.sortableHandler.getItemAt(this._sortableData,e)},e.prototype.indexOf=function(e){return this.sortableHandler.indexOf(this._sortableData,e)},e.prototype.removeItemAt=function(e){this.sortableHandler.removeItemAt(this._sortableData,e)},e.prototype.insertItemAt=function(e,t){this.sortableHandler.insertItemAt(this._sortableData,e,t)},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-container]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef},{type:g}]},e.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],sortableData:[{type:l.Input}],dropzones:[{type:l.Input,args:["dropZones"]}]},e}(D),C=function(s){function e(e,t,r,a,n,o){var i=s.call(this,e,t,r,o)||this;return i._sortableContainer=a,i._sortableDataService=n,i.onDragSuccessCallback=new l.EventEmitter,i.onDragStartCallback=new l.EventEmitter,i.onDragOverCallback=new l.EventEmitter,i.onDragEndCallback=new l.EventEmitter,i.onDropSuccessCallback=new l.EventEmitter,i.dropZones=i._sortableContainer.dropZones,i.dragEnabled=!0,i.dropEnabled=!0,i}return h(e,s),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype._onDragStartCallback=function(e){this._sortableDataService.isDragged=!0,this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this.element),this.dragDropService.isDragged=!0,this.dragDropService.dragData=this.dragData,this.dragDropService.onDragSuccessCallback=this.onDragSuccessCallback,this.onDragStartCallback.emit(this.dragDropService.dragData)},e.prototype._onDragOverCallback=function(e){this._sortableDataService.isDragged&&this.element!==this._sortableDataService.element&&(this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this.element),this.onDragOverCallback.emit(this.dragDropService.dragData))},e.prototype._onDragEndCallback=function(e){this._sortableDataService.isDragged=!1,this._sortableDataService.sortableContainer=null,this._sortableDataService.index=null,this._sortableDataService.markSortable(null);var t=this.dragDropService.dragData;this.dragDropService.isDragged=!1,this.dragDropService.dragData=null,this.dragDropService.onDragSuccessCallback=null,this.onDragEndCallback.emit(t)},e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged&&(this._sortableDataService.markSortable(this.element),this.index!==this._sortableDataService.index||this._sortableDataService.sortableContainer.sortableData!==this._sortableContainer.sortableData)){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer.sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this._sortableContainer.insertItemAt(t,this.index),this._sortableContainer.dropEnabled&&(this._sortableContainer.dropEnabled=!1),this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this.detectChanges()}},e.prototype._onDropCallback=function(e){this._sortableDataService.isDragged&&(this.onDropSuccessCallback.emit(this.dragDropService.dragData),this.dragDropService.onDragSuccessCallback&&this.dragDropService.onDragSuccessCallback.emit(this.dragDropService.dragData),this._sortableContainer.detectChanges())},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:S},{type:g},{type:l.ChangeDetectorRef}]},e.propDecorators={index:[{type:l.Input,args:["sortableIndex"]}],draggable:[{type:l.Input,args:["dragEnabled"]}],droppable:[{type:l.Input,args:["dropEnabled"]}],dragData:[{type:l.Input}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],onDragSuccessCallback:[{type:l.Output,args:["onDragSuccess"]}],onDragStartCallback:[{type:l.Output,args:["onDragStart"]}],onDragOverCallback:[{type:l.Output,args:["onDragOver"]}],onDragEndCallback:[{type:l.Output,args:["onDragEnd"]}],onDropSuccessCallback:[{type:l.Output,args:["onDropSuccess"]}]},e}(D),E=function(o){function e(e,t,r,a,n){return o.call(this,e,t,r,a,n)||this}return h(e,o),e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-handle]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:C},{type:l.ChangeDetectorRef}]},e}(b),_=[a,{provide:n,useFactory:o},{provide:g,useFactory:u,deps:[a]}],I=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:_}},e.decorators=[{type:l.NgModule,args:[{declarations:[v,m,y,S,C,E],exports:[v,m,y,S,C,E],entryComponents:[]}]}],e}();e.providers=_,e.DndModule=I,e.DataTransferEffect=r,e.DragDropConfig=a,e.DragImage=i,e.DraggableHandleDirective=m,e.DraggableDirective=v,e.DroppableDirective=y,e.SortableContainerDirective=S,e.SortableHandleDirective=E,e.SortableDirective=C,e.AbstractHandleDirective=b,e.AbstractDirective=D,e.DragDropSortableService=g,e.dragDropSortableServiceFactory=u,e.DragDropService=n,e.dragDropServiceFactory=o,e.ɵe=a,e.ɵa=a,e.ɵg=v,e.ɵh=m,e.ɵi=y,e.ɵj=S,e.ɵk=C,e.ɵl=E,e.ɵd=g,e.ɵf=u,e.ɵb=n,e.ɵc=o,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-dnd.umd.min.js.map