!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms")):"function"==typeof define&&define.amd?define("ng2-dnd",["exports","@angular/core","@angular/forms"],t):t(e["ng2-dnd"]={},e.ng.core,e.ng.forms)}(this,function(e,l,t){"use strict";var r=function(){function e(e){this.name=e}return e.COPY=new e("copy"),e.LINK=new e("link"),e.MOVE=new e("move"),e.NONE=new e("none"),e}(),a=function(){function e(){this.onDragStartClass="dnd-drag-start",this.onDragEnterClass="dnd-drag-enter",this.onDragOverClass="dnd-drag-over",this.onSortableDragClass="dnd-sortable-drag",this.dragEffect=r.MOVE,this.dropEffect=r.MOVE,this.dragCursor="move",this.defaultCursor="pointer"}return e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=l.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),n=function(){function e(){this.allowedDropZones=[]}return e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=l.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();function o(){return new n}var i=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),this.imageElement=e,this.x_offset=t,this.y_offset=r,"string"==typeof this.imageElement){var a=this.imageElement;this.imageElement=new HTMLImageElement,this.imageElement.src=a}};function s(e){return e!==undefined&&null!==e}var c=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e[t]},e.prototype.indexOf=function(e,t){return e.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.splice(t,1)},e.prototype.insertItemAt=function(e,t,r){e.splice(r,0,t)},e}(),d=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e.at(t)},e.prototype.indexOf=function(e,t){return e.controls.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.removeAt(t)},e.prototype.insertItemAt=function(e,t,r){e.insert(r,t)},e}(),p=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype.markSortable=function(e){s(this._element)&&this._element.classList.remove(this.config.onSortableDragClass),s(e)&&(this._element=e,this._element.classList.add(this.config.onSortableDragClass))},e.decorators=[{type:l.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a}]},e.ngInjectableDef=l.defineInjectable({factory:function(){return new e(l.inject(a))},token:e,providedIn:"root"}),e}();function g(e){return new p(e)}var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function f(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var h=function(e,t,r,a,n){this.dragDropService=t,this.config=r,this.directive=a,this.cdr=n,this.element=e.nativeElement,this.directive.dragHandle=this.element},b=function(){function e(e,t,r,a){var n=this;this.dragDropService=t,this.config=r,this.cdr=a,this._dragEnabled=!0,this.dropEnabled=!1,this.dropZones=[],this.cloneItem=!1,this.defaultCursor=this.config.defaultCursor,this.element=e.nativeElement,this.element.style.cursor=this.defaultCursor,this.element.ondragenter=function(e){return n.dragEnter(e)},this.element.ondragleave=function(e){return n.dragLeave(e)},this.element.ondrop=function(e){return n.drop(e)},this.element.ondragover=function(e){return n.dragOver(e),s(e.dataTransfer)&&(e.dataTransfer.dropEffect=n.config.dropEffect.name),!1},this.element.onmousedown=function(e){n.target=e.target},this.element.ondragstart=function(e){s(n.dragHandle)&&n.dragHandle.contains(n.target)?e.preventDefault():(n.dragStart(e),s(e.dataTransfer))}}return Object.defineProperty(e.prototype,"dragEnabled",{get:function(){return this._dragEnabled},set:function(e){this._dragEnabled=e,this.element.draggable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragHandle",{get:function(){return this._dragHandle},set:function(e){this._dragHandle=e},enumerable:!0,configurable:!0}),e.prototype.detectChanges=function(){var e=this;setTimeout(function(){e.cdr&&!e.cdr.destroyed&&e.cdr.detectChanges()},250)},e.prototype.dragEnter=function(e){this.isDropAllowed(e)&&this.dragEnterCallback(e)},e.prototype.dragOver=function(e){this.isDropAllowed(e)&&s(e.preventDefault)&&e.preventDefault(),this.dragOverCallback(e)},e.prototype.dragLeave=function(e){this.isDropAllowed(e)&&this.dragLeaveCallback(e)},e.prototype.drop=function(e){this.isDropAllowed(e)&&(this.preventAndStop(e),this.dropCallback(e),this.detectChanges())},e.prototype.dragStart=function(e){this.dragEnabled&&(this.dragDropService.allowedDropZones=this.dropZones,this.dragStartCallback(e))},e.prototype.dragEnd=function(e){this.dragDropService.allowedDropZones=[],this.dragEndCallback(e)},e.prototype.isDropAllowed=function(e){if((this.dragDropService.isDragged||e.dataTransfer&&e.dataTransfer.files)&&this.dropEnabled){if(s(this.allowDrop))return this.allowDrop(this.dragDropService.dragData);if(0===this.dropZones.length&&0===this.dragDropService.allowedDropZones.length)return!0;try{for(var t=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}(this.dragDropService.allowedDropZones),r=t.next();!r.done;r=t.next()){var a=r.value;if(-1!==this.dropZones.indexOf(a))return!0}}catch(i){n={error:i}}finally{try{r&&!r.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}}return!1;var n,o},e.prototype.preventAndStop=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},e.prototype.dragEnterCallback=function(e){},e.prototype.dragOverCallback=function(e){},e.prototype.dragLeaveCallback=function(e){},e.prototype.dropCallback=function(e){},e.prototype.dragStartCallback=function(e){},e.prototype.dragEndCallback=function(e){},e}(),D=function(o){function e(e,t,r,a){var n=o.call(this,e,t,r,a)||this;return n.onDragStart=new l.EventEmitter,n.onDragEnd=new l.EventEmitter,n.onDragSuccess=new l.EventEmitter,n.defaultCursor=n.element.style.cursor,n.dragEnabled=!0,n}return f(e,o),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype.dragStartCallback=function(){this.dragDropService.isDragged=!0,this.dragDropService.dragData=this.dragData,this.dragDropService.onDragSuccessCallback=this.onDragSuccess,this.element.classList.add(this.config.onDragStartClass)},e.prototype.dragEndCallback=function(e){this.dragDropService.isDragged=!1,this.dragDropService.dragData=null,this.dragDropService.onDragSuccessCallback=null,this.element.classList.remove(this.config.onDragStartClass),this.onDragEnd.emit({dragData:this.dragData,mouseEvent:e})},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef}]},e.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],dragData:[{type:l.Input}],dragImage:[{type:l.Input}],cloneItem:[{type:l.Input}],onDragStart:[{type:l.Output}],onDragEnd:[{type:l.Output}],onDragSuccess:[{type:l.Output}]},e}(b),v=function(o){function e(e,t,r,a,n){return o.call(this,e,t,r,a,n)||this}return f(e,o),e.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable-handle"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:D},{type:l.ChangeDetectorRef}]},e}(h),y=function(o){function e(e,t,r,a){var n=o.call(this,e,t,r,a)||this;return n.onDropSuccess=new l.EventEmitter,n.onDragEnter=new l.EventEmitter,n.onDragOver=new l.EventEmitter,n.onDragLeave=new l.EventEmitter,n.dropEnabled=!0,n}return f(e,o),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowdrop",{set:function(e){this.allowDrop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype.dragEnterCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.add(this.config.onDragEnterClass),this.onDragEnter.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dragOverCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.add(this.config.onDragOverClass),this.onDragOver.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dragLeaveCallback=function(e){this.dragDropService.isDragged&&(this.element.classList.remove(this.config.onDragOverClass),this.element.classList.remove(this.config.onDragEnterClass),this.onDragLeave.emit({dragData:this.dragDropService.dragData,mouseEvent:e}))},e.prototype.dropCallback=function(e){var t=e.dataTransfer;(this.dragDropService.isDragged||s(t)&&s(t.files))&&(this.onDropSuccess.emit({dragData:this.dragDropService.dragData,mouseEvent:e}),s(this.dragDropService.onDragSuccessCallback)&&this.dragDropService.onDragSuccessCallback.emit({dragData:this.dragDropService.dragData,mouseEvent:e}),this.element.classList.remove(this.config.onDragOverClass),this.element.classList.remove(this.config.onDragEnterClass))},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-droppable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef}]},e.propDecorators={droppable:[{type:l.Input,args:["dropEnabled"]}],allowdrop:[{type:l.Input,args:["allowDrop"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],onDropSuccess:[{type:l.Output}],onDragEnter:[{type:l.Output}],onDragOver:[{type:l.Output}],onDragLeave:[{type:l.Output}]},e}(b),m=function(i){function e(e,t,r,a,n){var o=i.call(this,e,t,r,a)||this;return o._sortableDataService=n,o._sortableData=[],o.dragEnabled=!1,o}return f(e,i),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortableData",{get:function(){return this._sortableData},set:function(e){(this._sortableData=e)instanceof t.FormArray?this.sortableHandler=new d:this.sortableHandler=new c,this.dropEnabled=!!this._sortableData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);-1===this.indexOf(t)&&(this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer._sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this.insertItemAt(t,0),(this._sortableDataService.sortableContainer=this)._sortableDataService.index=0),this.detectChanges()}},e.prototype.getItemAt=function(e){return this.sortableHandler.getItemAt(this._sortableData,e)},e.prototype.indexOf=function(e){return this.sortableHandler.indexOf(this._sortableData,e)},e.prototype.removeItemAt=function(e){this.sortableHandler.removeItemAt(this._sortableData,e)},e.prototype.insertItemAt=function(e,t){this.sortableHandler.insertItemAt(this._sortableData,e,t)},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-container]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:l.ChangeDetectorRef},{type:p}]},e.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],sortableData:[{type:l.Input}],dropzones:[{type:l.Input,args:["dropZones"]}]},e}(b),S=function(s){function e(e,t,r,a,n,o){var i=s.call(this,e,t,r,o)||this;return i._sortableContainer=a,i._sortableDataService=n,i.onDragSuccessCallback=new l.EventEmitter,i.onDragStartCallback=new l.EventEmitter,i.onDragOverCallback=new l.EventEmitter,i.onDragEndCallback=new l.EventEmitter,i.onDropSuccessCallback=new l.EventEmitter,i.dropZones=i._sortableContainer.dropZones,i.dragEnabled=!0,i.dropEnabled=!0,i}return f(e,s),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype._onDragStartCallback=function(e){this._sortableDataService.isDragged=!0,this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this.element),this.dragDropService.isDragged=!0,this.dragDropService.dragData=this.dragData,this.dragDropService.onDragSuccessCallback=this.onDragSuccessCallback,this.onDragStartCallback.emit(this.dragDropService.dragData)},e.prototype._onDragOverCallback=function(e){this._sortableDataService.isDragged&&this.element!==this._sortableDataService.element&&(this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this.element),this.onDragOverCallback.emit(this.dragDropService.dragData))},e.prototype._onDragEndCallback=function(e){this._sortableDataService.isDragged=!1,this._sortableDataService.sortableContainer=null,this._sortableDataService.index=null,this._sortableDataService.markSortable(null),this.dragDropService.isDragged=!1,this.dragDropService.dragData=null,this.dragDropService.onDragSuccessCallback=null,this.onDragEndCallback.emit(this.dragDropService.dragData)},e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged&&(this._sortableDataService.markSortable(this.element),this.index!==this._sortableDataService.index||this._sortableDataService.sortableContainer.sortableData!==this._sortableContainer.sortableData)){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer.sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this._sortableContainer.insertItemAt(t,this.index),this._sortableContainer.dropEnabled&&(this._sortableContainer.dropEnabled=!1),this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this.detectChanges()}},e.prototype._onDropCallback=function(e){this._sortableDataService.isDragged&&(this.onDropSuccessCallback.emit(this.dragDropService.dragData),this.dragDropService.onDragSuccessCallback&&this.dragDropService.onDragSuccessCallback.emit(this.dragDropService.dragData),this._sortableContainer.detectChanges())},e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:m},{type:p},{type:l.ChangeDetectorRef}]},e.propDecorators={index:[{type:l.Input,args:["sortableIndex"]}],draggable:[{type:l.Input,args:["dragEnabled"]}],droppable:[{type:l.Input,args:["dropEnabled"]}],dragData:[{type:l.Input}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],onDragSuccessCallback:[{type:l.Output,args:["onDragSuccess"]}],onDragStartCallback:[{type:l.Output,args:["onDragStart"]}],onDragOverCallback:[{type:l.Output,args:["onDragOver"]}],onDragEndCallback:[{type:l.Output,args:["onDragEnd"]}],onDropSuccessCallback:[{type:l.Output,args:["onDropSuccess"]}]},e}(b),C=function(o){function e(e,t,r,a,n){return o.call(this,e,t,r,a,n)||this}return f(e,o),e.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-handle]"}]}],e.ctorParameters=function(){return[{type:l.ElementRef},{type:n},{type:a},{type:S},{type:l.ChangeDetectorRef}]},e}(h),E=[a,{provide:n,useFactory:o},{provide:p,useFactory:g,deps:[a]}],_=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:E}},e.decorators=[{type:l.NgModule,args:[{declarations:[D,v,y,m,S,C],exports:[D,v,y,m,S,C],entryComponents:[]}]}],e}();e.providers=E,e.DndModule=_,e.AbstractHandleDirective=h,e.AbstractDirective=b,e.DataTransferEffect=r,e.DragDropConfig=a,e.DragImage=i,e.DraggableHandleDirective=v,e.DraggableDirective=D,e.DroppableDirective=y,e.SortableContainerDirective=m,e.SortableHandleDirective=C,e.SortableDirective=S,e.ɵe=a,e.ɵa=a,e.ɵg=D,e.ɵh=v,e.ɵi=y,e.ɵj=m,e.ɵk=S,e.ɵl=C,e.ɵd=p,e.ɵf=g,e.ɵb=n,e.ɵc=o,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-dnd.umd.min.js.map